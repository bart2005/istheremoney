<!doctype html>
<html lang="ru">

<head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-NQ3TSGL1DW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-NQ3TSGL1DW');
  </script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Настройка сайта, часть 2 | isthere.money</title>
  <meta name="description"
    content="Нужен ли parcel build, решение проблем c Cloudflare и robots.txt, сокрытие preview deployments ссылок">
  <link rel="canonical" href="https://isthere.money"/articles/2026-01-15_first_steps/index.html" />
  <link rel="stylesheet" href="/src/style.css">
</head>


<body>
  <header>
    <a href="/">isthere.money</a>
  </header>
  <main>
    <article>
      <h1>Основная идея и вторые шаги</h1>
      <div><a href="/src/articles/2026-01-14_main_idea/index.html">Ранее: Основная идея и первые шаги</a></div>
      <time class="date">
        <p>2026.01.15</p>
      </time>
      <time>12:32:57</time>
      <div>
        Внезапно я подумал, а не является ли parcel для сайта состоящего из html и палок слегка перебором?
        Плюсы есть.Правишь код, hotreload обновляет, приятно. Но сайт я задеплоил, проверил в Lighthouse и увидел что
        там не так уже и 100 из 100.
        Не дело, погружаемся в глубины оптимизации.
      </div>
      <div>Очевидное я быстро пофиксал, уже и забыл что сделал. Но появился вопрос со звездочкой.</div>
      <h2>Cloudflare и robots.txt</h2>
      <div>
        Один из вопросов с подвохом - а где robots.txt? Не, его у меня у самого не было, однако после добавления в
        deployment конфиг Cloudflare
        <pre><code>npm parcel build</code></pre> билд его не кладет его в /dist, а Cloudflare по-умолчанию его не
        генерит как надо. Вернее генерит но в итоге там какая-то мешанина, ай, нехота тут возиться.
        Ладно, пока апдейт, так-то хотя бы частичная мегаоптимизация сайта (дефолтный css от ванильного parcel проекта
        малость не очень - на мобильнике текст убегал) уже пускай будет. С роботами вечером сражусь.
      </div>
      <br />

      <time>20:33:14</time>
      <div>
        Clourflare + parcel равняется возня с robots.txt. Пока решаю не трогать билд parcel, а использовать чистый код
        сайта.
        Parcel удобно для hotreload, но неохота возиться с настройкой. А, ну и, конечно, результирующий бандл содержит
        некий Javascript с вызовами куда-то, а я это и не использую. Спросил ИИ и он говорит про Cloudflare аналитику.
        В целом, аналитика явно понадобится, это я вообще планирую где-то рядом постить, чтобы был понятен прогресс и
        тренды. Но думаю использовать гугловую, короче, пока в топку.
      </div>


      <h2>Настройка доступа к preview адресу</h2>
      <time>21:28:36</time>
      <div>
        Cloudflare генерит preview с урлом типа https://*pages.dev/ . Понятно, что его надо убрать от возможной
        индексации. Настраивается через конфиг путем включения Access Policy в настройках Workers & Pages. Ну ок,
        включаем. Открываю браузер - доступен. Открываю brave инкогнито - нет доступа. Firefox - блин, доступен. Иду
        опять в доку, <a
          href="https://developers.cloudflare.com/pages/configuration/preview-deployments/#x-robots-tag-noindex-on-preview-deployments"
          rel="nofollow noopener noreferrer" target="_blank">чекни через curl говорят</a>. Ну curl уже не открывает.
        Смотрю опять доку - Cloudflare будто по дефолту пытается его скрыть от поисковиков. Вообщем, провозившись еще
        час, я получил непонятно как доступный через браузер, но не curl адрес preview. Ну посмотрим, пока в индексе
        вообще никого.
      </div>


      <h2>Cloudflare и аналитика</h2>
      <div>Я тут давеча приобретал домен .online. Он был отправлен на vps и через 2 дня появился в индексе как огурчик.
        Интересно... А этот где?</div>
      <div>
        Кстати, ковыряя Cloudflare dashboard, я весьма случайно наткнулся на возможность отключения (не пробовал, но так
        выглядит) аналитики для сайта. Это тот самый скрипт который Cloudflare сует без моего ведома. Оказывается, можно
        поправить. Это в разделе Analytics & logs -> Web Analytics
        (https://dash.cloudflare.com/.../web-analytics/edit/...). А что это не очевидно-то через конфиг деплоя?
      </div>
      <h2>Cloudflare и robots.txt, часть 2</h2>
      <div>
        Оказывается есть страничка типа https://dash.cloudflare.com/?to=/:account/:zone/, где можно удалить настройки
        Cloudflare для robots.txt и оставить свои либо вообще выпилить. Удалил, да, работает, lighthouse доволен. И тут
        же скинул мне 2 балла за загрузку моих стилей. Стилей, Карл. Тут нет стилей, он один, из 2 строчек. Короче
        плюнул я на перфекционизм, вернул и роботов и parcel packaging заодно. Не он виноватый был оказывается.
      </div>
      <h2>Parcel и robots.txt</h2>
      <div>
        <b>UPD:</b>
        Все-таки parcel сборка через
        <pre><code>npm parcel build</code></pre> портит robots.txt. Parcel без танцев не включает его в сборку и вместе
        с
        Cloudflare дорисовывает в /robots.txt заглавную index.html
        Пришлось применить хитрость. Добавил это
        <p>
          <code>&lt;a style=&quot;display: none&quot; href=&quot;/src/robots.txt&quot; aria-label=&quot;robots&quot;&gt;&lt;/a&gt;</code>
        </p>
        Robots.txt от Cloudflare скопировал локально, а там отключил.

      </div>
      <div>Ура, 100 из 100 в lightouse</div>
      <div>
        Вообщем пуш и до завтра. Блин, домен еще надо купить для английской версии.
      </div>

      <p></p><a href="/src/articles/2026-01-16_how_domain_name_impacts/index.html">Далее: Влияние домена на
        индексацию</a></p>

    </article>
  </main>
  <footer>
    <a href="https://t.me/istheremoney/13" target="_blank" rel="noopener noreferrer">Обсуждение в Telegram</a>
  </footer>
</body>


</html>